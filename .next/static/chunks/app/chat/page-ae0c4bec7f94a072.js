(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{2217:function(e,r,t){Promise.resolve().then(t.bind(t,4723))},4723:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return n}});var i=t(7437),d=t(2265),o=t(9487),a=t(5616);function n(){let[e,r]=d.useState("tia"),[t,n]=d.useState(""),[s,l]=d.useState([{from:"character",characterId:"tia",text:"ティアだよ。ルーちゃん、なんとなく話したくなったら、なんでも聞いてみてね。"}]),[c,f]=d.useState(!1),p=d.useRef(null);d.useEffect(()=>{var e;null===(e=p.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[s]);let u=async()=>{if(!t.trim())return;let r=t.trim();n(""),l(e=>[...e,{from:"user",text:r}]),f(!0);try{let t=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({characterId:e,userMessage:r,history:s.slice(-6)})});if(!t.ok)throw Error("failed");let i=await t.json();l(r=>[...r,{from:"character",characterId:e,text:i.message}])}catch(r){l(r=>[...r,{from:"character",characterId:e,text:"ちょっとお返事がうまく送れなかったみたい…。でも、ルーちゃんの話を聞けたのはうれしいよ。"}])}finally{f(!1)}},x=o.R.find(r=>r.id===e);return(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",minHeight:"calc(100vh - 80px)"},children:[(0,i.jsx)("h2",{style:{fontSize:22,marginBottom:8},children:"おしゃべりルーム"}),(0,i.jsxs)("p",{style:{fontSize:13,color:"#666",marginBottom:8},children:[x.name,"とお話しできるよ。ルーちゃんの気持ちや、勉強のこととか、なんでも話してみてね。"]}),(0,i.jsxs)("div",{style:{marginBottom:8},children:[(0,i.jsx)("label",{style:{fontSize:13,display:"block",marginBottom:4,fontWeight:600},children:"だれと話す？"}),(0,i.jsx)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:o.R.map(t=>(0,i.jsxs)("button",{onClick:()=>{r(t.id),l([{from:"character",characterId:t.id,text:"".concat(t.name,"だよ。ルーちゃん、ここに来てくれてうれしいな。\n")+"話したいことや聞きたいこと、なんでも投げてみてね。"}])},style:{padding:"6px 10px",borderRadius:999,border:e===t.id?"2px solid #ff9ecb":"1px solid #ddd",backgroundColor:e===t.id?"#fff0f6":"#ffffff",fontSize:13,cursor:"pointer"},children:["rabbit"===t.species?"\uD83D\uDC30":"\uD83D\uDC36"," ",t.name]},t.id))})]}),(0,i.jsx)("div",{style:{flex:1,overflowY:"auto",padding:"8px 0",borderRadius:12,backgroundColor:"#fff",border:"1px solid #eee",marginBottom:10},children:(0,i.jsxs)("div",{style:{padding:"0 8px"},children:[s.map((e,r)=>"character"===e.from?(0,i.jsx)(a.F,{characterId:e.characterId,text:e.text},r):(0,i.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",margin:"8px 0"},children:(0,i.jsx)("div",{style:{backgroundColor:"#e1f5fe",padding:"8px 10px",borderRadius:16,maxWidth:"75%",fontSize:14,whiteSpace:"pre-wrap"},children:e.text})},r)),(0,i.jsx)("div",{ref:p})]})}),(0,i.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,i.jsx)("textarea",{value:t,onChange:e=>n(e.target.value),rows:2,placeholder:"ルーちゃんの気持ちや、話したいことを書いてみてね",style:{flex:1,borderRadius:8,border:"1px solid #ddd",padding:8,fontSize:14,resize:"none"}}),(0,i.jsx)("button",{onClick:u,disabled:c,style:{padding:"8px 12px",borderRadius:10,border:"none",background:"linear-gradient(135deg, #ffb6c1 0%, #ffd1ff 50%, #ffe4b5 100%)",fontSize:14,fontWeight:600,cursor:"pointer",minWidth:68},children:c?"…":"送信"})]})]})}},5616:function(e,r,t){"use strict";t.d(r,{F:function(){return o}});var i=t(7437);t(2265);var d=t(9487);let o=e=>{var r;let{characterId:t,text:o}=e,a=null!==(r=d.R.find(e=>e.id===t))&&void 0!==r?r:d.R[0],n="rabbit"===a.species?"\uD83D\uDC30":"\uD83D\uDC36";return(0,i.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:12,margin:"12px 0"},children:[(0,i.jsx)("div",{style:{padding:4,borderRadius:18,background:"linear-gradient(135deg, #d7b18b 0%, #c09363 40%, #a97a4c 100%)",boxShadow:"0 2px 0 #7a4a24",flexShrink:0},children:(0,i.jsx)("div",{style:{width:56,height:56,borderRadius:14,backgroundColor:a.colorCode,border:"2px solid rgba(255,255,255,0.8)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:11},children:(0,i.jsxs)("div",{style:{textAlign:"center",lineHeight:1.2},children:[(0,i.jsx)("div",{style:{fontSize:20},children:n}),(0,i.jsx)("div",{children:a.name})]})})}),(0,i.jsxs)("div",{style:{position:"relative",maxWidth:"100%",padding:"10px 14px",borderRadius:18,background:"linear-gradient(135deg, #f3ffe8 0%, #fffdf7 40%, #ffeaf2 100%)",border:"1px solid rgba(188, 209, 170, 0.9)",boxShadow:"0 3px 0 rgba(150, 171, 132, 0.9)"},children:[(0,i.jsx)("div",{style:{position:"absolute",left:-9,top:20,width:0,height:0,borderTop:"9px solid transparent",borderBottom:"9px solid transparent",borderRight:"9px solid #e9f9dd",filter:"drop-shadow(0 1px 0 rgba(150,171,132,0.7))"}}),(0,i.jsx)("div",{style:{fontSize:13,whiteSpace:"pre-wrap",color:"#4b3a2a"},children:o})]})]})}},9487:function(e,r,t){"use strict";t.d(r,{L:function(){return d},R:function(){return i}});let i=[{id:"tia",name:"ティア",species:"rabbit",colorName:"クリーム",colorCode:"#ffe0b2"},{id:"mochu",name:"もちゅ",species:"rabbit",colorName:"茶色",colorCode:"#d7a56b"},{id:"syrup",name:"シロップ",species:"rabbit",colorName:"灰色",colorCode:"#b0bec5"},{id:"puffi",name:"ぱふぃー",species:"dog",colorName:"白",colorCode:"#ffffff"}];function d(){return i[Math.floor(Math.random()*i.length)]}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=2217)}),_N_E=e.O()}]);